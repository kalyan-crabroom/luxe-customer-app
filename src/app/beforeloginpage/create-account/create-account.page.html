<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button text="" defaultHref="/" icon="assets/icons/back-btn-arrow.svg"></ion-back-button>
    </ion-buttons>
    <ion-title>Create an Account</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <form [formGroup]="signUp" (ngSubmit)="onSubmit(signUp.value)">
    <ion-grid class="ion-padding" [fixed]="true">
      <ion-row>
        <!-- <ion-col size="12">
          <h1 class="page-title mb-30">Create an Account</h1>
        </ion-col> -->
        <ion-col size="12">
          <ion-item lines="none" class="field">
            <ion-icon name="person-circle" slot="start"></ion-icon>
            <ion-input type="text" placeholder="Enter First Name" formControlName="first_name"
              appCapitalizeFirst></ion-input>
          </ion-item>
          <ng-container *ngFor="let validation of validation_messages.first_name">
            <p class="err"
              *ngIf="signUp.get('first_name')?.hasError(validation.type) && (signUp.get('first_name')?.dirty || signUp.get('first_name')?.touched)">
              <ion-icon name="information-circle-outline"></ion-icon>{{ validation.message }}
            </p>
          </ng-container>
        </ion-col>
        <ion-col size="12">
          <ion-item lines="none" class="field">
            <ion-icon name="person-circle" slot="start"></ion-icon>
            <ion-input type="text" placeholder="Enter Last Name" formControlName="last_name"
              appCapitalizeFirst></ion-input>
          </ion-item>
          <ng-container *ngFor="let validation of validation_messages.last_name">
            <p class="err"
              *ngIf="signUp.get('last_name')?.hasError(validation.type) && (signUp.get('last_name')?.dirty || signUp.get('last_name')?.touched)">
              <ion-icon name="information-circle-outline"></ion-icon>{{ validation.message }}
            </p>
          </ng-container>
        </ion-col>



        <ion-col size="12">
          <ion-item lines="none" class="field">
            <ion-icon name="mail" slot="start"></ion-icon>
            <ion-input type="text" placeholder="Enter Email Address" formControlName="email"></ion-input>
          </ion-item>
          <ng-container *ngFor="let validation of validation_messages.email">
            <p class="err"
              *ngIf="signUp.get('email')?.hasError(validation.type) && (signUp.get('email')?.dirty || signUp.get('email')?.touched)">
              <ion-icon name="information-circle-outline"></ion-icon>{{ validation.message }}
            </p>
          </ng-container>
        </ion-col>

        <ion-col size="12">
          <ion-item lines="none" class="field">
            <ion-icon name="location" slot="start"></ion-icon>
            <ion-input type="tel" placeholder="ZIP Code" formControlName="zip_code" maxlength="7"
              minlength="5"></ion-input>
          </ion-item>
          <ng-container *ngFor="let validation of validation_messages.zip_code">
            <p class="err"
              *ngIf="signUp.get('zip_code')?.hasError(validation.type) && (signUp.get('zip_code')?.dirty || signUp.get('zip_code')?.touched)">
              <ion-icon name="information-circle-outline"></ion-icon>{{ validation.message }}
            </p>
          </ng-container>
        </ion-col>

        <!-- <ion-col size="12">

          <ion-item lines="none" class="field relative-item">

            <ion-select toggleIcon="" placeholder="Select Timezone" formControlName="timezone">
              <ion-select-option value="{{item}}" *ngFor="let item of usaTimezones">{{ item }}</ion-select-option>
            </ion-select>

            <ion-icon name="caret-down-outline" class="icon-right"></ion-icon>
          </ion-item>

          <ng-container *ngFor="let validation of validation_messages.timezone">
            <p class="err"
              *ngIf="signUp.get('timezone')?.hasError(validation.type) && (signUp.get('timezone')?.dirty || signUp.get('timezone')?.touched)">
              <ion-icon name="information-circle-outline"></ion-icon>{{ validation.message }}
            </p>
          </ng-container>

        </ion-col> -->

        <ion-col size="12">
          <ion-item lines="none" class="field">
            <ion-icon name="call" slot="start"></ion-icon>
            <ion-input type="tel" placeholder="Phone Number" formControlName="phone"></ion-input>
          </ion-item>

          <ng-container *ngFor="let validation of validation_messages.phone">
            <p class="err"
              *ngIf="signUp.get('phone')?.hasError(validation.type) && (signUp.get('phone')?.dirty || signUp.get('phone')?.touched)">
              <ion-icon name="information-circle-outline"></ion-icon>{{ validation.message }}
            </p>
          </ng-container>
        </ion-col>

        <ion-col size="12">
          <ion-item lines="none" class="field">
            <ion-icon name="lock-closed" slot="start"></ion-icon>
            <ion-input [type]="passwordtype" placeholder="Enter Password" formControlName="password"
              minlength="5"></ion-input>
            <ion-icon slot="end" class="eye" [name]="passwordicon" (click)="hideShowPassword()"></ion-icon>
          </ion-item>
          <ng-container *ngFor="let validation of validation_messages.password">
            <p class="err"
              *ngIf="signUp.get('password')?.hasError(validation.type) && (signUp.get('password')?.dirty || signUp.get('password')?.touched)">
              <ion-icon name="information-circle-outline"></ion-icon>{{ validation.message }}
            </p>
          </ng-container>
        </ion-col>

        <ion-col size="12">
          <ion-item lines="none" class="field">
            <ion-icon name="lock-closed" slot="start"></ion-icon>
            <ion-input [type]="passwordType" placeholder="Confirm Password"
              formControlName="confirm_password"></ion-input>
            <ion-icon [name]="passwordIcon" (click)="hideShowPassword('confirm')" slot="end" class="eye"></ion-icon>
          </ion-item>
          <span *ngIf="signUp.hasError('passwordNotMatch') && signUp.controls['confirm_password'].dirty" class="err">
            <ion-icon class="erricon" name="information-circle-outline"></ion-icon>Password Not Match</span>
        </ion-col>

        <ion-col size="12" class="mt-15 mb-15">

          <ion-checkbox class="checkbox-custom" alignment="start" labelPlacement="end" justify-content="start"
            formControlName="terms" (ionChange)="acceptTermCondition($event)">I agree to the <strong
              routerLink="/terms-conditions">Terms of
              Service</strong> & <strong routerLink="/privacy-policy">Privacy
              Policy </strong>
          </ion-checkbox>

        </ion-col>

        <ion-col size="12" class="mb-15">

          <ion-checkbox class="checkbox-custom" alignment="start" labelPlacement="end" justify-content="start"
            formControlName="term_non_sexual" (ionChange)="acceptTermNonSexual($event)">I understand and agree that all
            massages are strictly non-sexual, and any misconduct will result in removal from the platform.
          </ion-checkbox>

        </ion-col>

        <ion-col size="12" size-md="6" offset-md="3" class="mt-15">
          <ion-button type="submit" expand="block" class="primary-btn"
            [disabled]="!signUp.valid || !terms_checked || !terms_non_sexual">Submit</ion-button>
        </ion-col>
      </ion-row>
    </ion-grid>
    <!-- </form> -->

    <ion-modal [isOpen]="isModalOpen" class="modal-center" [backdropDismiss]="false">
      <ng-template>
        <ion-content>
          <ion-grid class="flex-grid-modal">
            <ion-row>
              <ion-col size="12">
                <ion-icon src="assets/icons/pop-up.svg"></ion-icon>
                <h1>Thank You</h1>
                <p>{{responseMessage}}</p>
                <ion-button expand="block" class="primary-btn" (click)="goToLogin()">Ok</ion-button>
              </ion-col>
            </ion-row>
          </ion-grid>
        </ion-content>
      </ng-template>
    </ion-modal>

    <ion-modal [isOpen]="isModalOpen2" class="modal-center" [backdropDismiss]="false">
      <ng-template>
        <ion-content>
          <ion-grid class="flex-grid-modal">
            <ion-row>
              <ion-icon name="close-circle" class="close-icon" (click)="gotoModel()"></ion-icon>
              <ion-col size="12">
                <ion-icon name="alert-circle-outline" class="alert-icon"></ion-icon>
                <h1>Services Unavailable</h1>
                <p>Luxe Touch is not yet available in your area, but may be coming soon. If you would still like to book
                  an appointment, please update your location</p>
                <ion-item lines="none" class="field">
                  <ion-icon name="location" slot="start" size="small"></ion-icon>
                  <ion-input type="tel" placeholder="ZIP Code" formControlName="zip_code"></ion-input>
                </ion-item>
                <ng-container *ngFor="let validation of validation_messages.zip_code">
                  <p class="err1"
                    *ngIf="signUp.get('zip_code')?.hasError(validation.type) && (signUp.get('zip_code')?.dirty || signUp.get('zip_code')?.touched)">
                    <ion-icon name="information-circle-outline" size="small"></ion-icon>{{ validation.message }}
                  </p>
                </ng-container>
                <ion-button expand="block" class="primary-btn" (click)="updateLocation()" type="submit"
                  [disabled]="signUp.invalid">Update Location</ion-button>
              </ion-col>
            </ion-row>
          </ion-grid>
        </ion-content>
      </ng-template>
    </ion-modal>
  </form>


  <ion-modal [isOpen]="isModalEmail" class="modal-center" [backdropDismiss]="false">
    <ng-template>
      <ion-content>
        <form [formGroup]="emailForm" (ngSubmit)="submitOtp(emailForm.value)">
          <ion-grid class="flex-grid-modal">
            <ion-row>
              <ion-icon name="close-circle" class="close-icon" (click)="emailModal(false)"></ion-icon>
              <ion-col size="12">
                <ion-icon name="alert-circle-outline" class="alert-icon"></ion-icon>
                <h1>Enter Code</h1>
                <p>Success! Please enter the code that was sent to the email.</p>
                <ion-item lines="none" class="field">
                  <ion-input type="tel" placeholder="Enter Code" formControlName="otp"></ion-input>
                </ion-item>

                <ng-container *ngFor="let validation of validation_messages.otp">
                  <p class="err1"
                    *ngIf="emailForm.get('otp')?.hasError(validation.type) && (emailForm.get('otp')?.dirty || emailForm.get('otp')?.touched)">
                    <ion-icon name="information-circle-outline" size="small"></ion-icon>{{ validation.message }}
                  </p>
                </ng-container>
                <ion-button expand="block" class="primary-btn mt-30" type="submit"
                  [disabled]="emailForm.invalid">Submit</ion-button>

                <ion-button (click)="sendAgainOtp()" class="primary-btn ion-margin-top" expand="block">Send
                  Again</ion-button>
              </ion-col>
            </ion-row>
          </ion-grid>
        </form>
      </ion-content>
    </ng-template>
  </ion-modal>

</ion-content>