<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button text="" defaultHref="/" icon="assets/icons/back-btn-arrow.svg"></ion-back-button>
    </ion-buttons>
    <ion-title>LUXE TOUCH CREDITS</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-grid [fixed]="true">

    <ion-row>
      <ion-col size="12">
        <div class="card-container">
          <ion-card class="amount-card">
            <h1>{{wallet_amount | currency}}</h1>
            <p>Available Amount</p>
            <div class="ion-text-center mt-15">
              <ion-text class="add_card" (click)="openModel(true)">
                <ion-icon name="add-circle"></ion-icon>
                <ion-text>Add Amount</ion-text>
              </ion-text>
            </div>
          </ion-card>

        </div>

      </ion-col>
      <ion-col size="12">
        <ion-list class="ion-padding list-style">
          <ion-list-header class="ion-no-padding">
            <ion-label class="ion-no-margin">Luxe Touch Credits History</ion-label>
          </ion-list-header>
          <div class="ion-text-center ion-padding" *ngIf="is_wallet_ready">
            <ion-spinner color="light"></ion-spinner>
          </div>
          <ion-item lines="none" detail="false" *ngFor="let item of wallet_log">
            <ion-label>
              <h3>{{ item.created_at | date: 'MM/dd/yyyy' }}</h3>
            </ion-label>
            <ion-text slot="end" class="price-text">
              {{item.amount | currency}}
              <br>
              {{ item.type | titlecase }}
            </ion-text>
          </ion-item>
          <div class="no-found" *ngIf="!is_wallet_ready && wallet_log.length == 0">
            <p>No Found.</p>
          </div>
        </ion-list>
      </ion-col>
    </ion-row>



  </ion-grid>

  <ion-modal [isOpen]="isWalletModel" class="modal-style-1" [backdropDismiss]="false">
    <ng-template>

      <form class="flex-container-box" [formGroup]="walletForm" (ngSubmit)="onSubmit(walletForm.value)">
        <div class="modal-body">
          <div class="modal-header">
            <ion-grid>
              <ion-row>
                <ion-col size="12">
                  <ion-item lines="none" class="field">
                    <ion-input type="tel" formControlName="amount" placeholder="Enter amount"></ion-input>
                  </ion-item>
      
                  <ng-container *ngFor="let validation of validation_messages.amount">
                    <p class="err"
                      *ngIf="walletForm.get('amount')?.hasError(validation.type) && (walletForm.get('amount')?.dirty || walletForm.get('amount')?.touched)">
                      <ion-icon name="information-circle-outline"></ion-icon>{{ validation.message }}
                    </p>
                  </ng-container>
      
                </ion-col>
              </ion-row>
            </ion-grid>
          </div>
          <div class="modal-content">
            <ion-grid>
              <ion-row>
                <ion-col size="12">
                  <div class="flex-title mb-15">
                    <h5 class="section-title mb-0 mt-0">Select Payment Method</h5>
                    <ion-icon name="add-circle" (click)="addCard()"></ion-icon>
                  </div>
                 
                  <div class="ion-text-center ion-padding" *ngIf="ready">
                    <ion-spinner color="light"></ion-spinner>
                  </div>
                  <div class="no-found" *ngIf="!ready && paymentMethodList.cards.length === 0">
                    <p>No Cards Found.</p>
                  </div>

                  <ion-list class="list-style" *ngIf="!ready && paymentMethodList.cards.length > 0">
                    <ion-radio-group formControlName="card_id">
                      <ion-item lines="none" class="card-item" *ngFor="let item of paymentMethodList.cards">
                        <ion-icon src="assets/icons/card-bg.svg" slot="start"></ion-icon>
                        <ion-radio mode="md" class="choose" justify="space-between" [value]="item.card_id"
                          labelPlacement="start">{{item.card_name | titlecase}} {{item.ending_in}}</ion-radio>
                      </ion-item>
                    </ion-radio-group>
                  </ion-list>

                </ion-col>
              </ion-row>
            </ion-grid>

          </div>
          <div class="modal-footer">
            <ion-grid>
              <ion-row>
                <ion-col size="12" size-sm="6">
                  <ion-button class="primary-btn" expand="block" [disabled]="walletForm.invalid" type="submit" >Submit</ion-button>
                </ion-col>
                <ion-col size="12" size-sm="6">
                  <ion-button class="primary-btn" expand="block" (click)="openModel(false)">Cancel</ion-button>
                </ion-col>
              </ion-row>
            </ion-grid>

          </div>
        </div>
      </form>

    </ng-template>
  </ion-modal>
</ion-content>